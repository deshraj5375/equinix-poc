#! /usr/bin/groovy

node()
{

def tftool = tool name: 'terraform'

stage('checkout phase')
{
  checkout scm
}
stage('terraform-plan')
{
    withCredentials([[$class: 'AmazonWebServicesCredentialsBinding', accessKeyVariable: 'AWS_ACCESS_KEY_ID', credentialsId: 'DeshrajAdmin', secretKeyVariable: 'AWS_SECRET_ACCESS_KEY']]) {
    dir("${WORKSPACE/ALB-instance/TIB-ALB-A}")
    {
                        sh 'terraform fmt'
						sh 'terraform init -input=false'
						sh 'terraform validate'
						sh 'terraform plan -out=tfplan -input=false'						
    }
}

}

stage('terraform-apply')
{

    
}

}